# 修改方案

### 1. 针对“多跳推理流于形式 (Fake Multi-hop)”的修改方案

**核心策略：强制实施“逻辑路由”**
目前的扩链是“顺流而下”的（看到A -> 推出B），这很容易形成捷径。你需要强制模型在 `Extension Loop` 中执行**“汇聚” **或** “分支”**逻辑。

* **修改 Prompts（Prompt 策略）** ：
  在 `Extension` 阶段，不再只是让模型“下一步”，而是强制其在以下两种**逻辑模板**中二选一：

1. **双源合成模式 (Synthesis)** ：要求模型必须提取一个 **视觉数值** （来自图）和一个 **文本参数** （来自参考文档），通过计算公式结合得出结论。
   * *口令示例* ：“找出图中的读数 X，找出文档中的系数 Y，计算 X * Y。”
2. **条件分支模式 (Branching)** ：要求参考文档提供“多路分支条件”（如：温度>50用公式A，否则用B），而模型必须通过**视觉观察**来决定走哪条路。
   * *口令示例* ：“根据图中物体的颜色/状态，决定适用文档中的哪一条规则。”

* **修改 Pipeline（流程控制）** ：
  在 `steps/` 的迭代中引入 **逻辑校验** ：
* 检查 `modal_use`（模态使用情况）。
* **硬性规则** ：如果连续两步都是 Pure Text 或 Pure Image，直接丢弃该 Step，强制重试，要求必须发生 `Cross-Modal Bridge`（跨模态桥接）。

---

### 2. 针对“干扰项 (Distractors) 太弱”的修改方案

**核心策略：基于“逆向工程”生成陷阱**
目前的干扰项是最后顺手生成的，容易被一眼识破。需要将干扰项的生成 **前置** ，并基于**人类易错点**设计。

* **修改 Prompts（Prompt 策略）** ：
  在 `Final/Compress` 阶段，拆解生成指令，要求模型先不写选项，而是先执行**“陷阱设计 (Trap Design)”**：
* **指令要求** ：生成正确答案前，先列出 3 个“高智商错误路径”：
  1. **单位陷阱** ：计算正确但单位未换算（如 kW vs W）。
  2. **视觉误读** ：假设用户看错了刻度或颜色，会得出什么结果？
  3. **条件误用** ：假设用户套用了错误的文档公式（如把“夏季标准”用在“冬季”图上），结果是多少？
* **生成映射** ：将这 3 个错误结果直接映射为选项 B、C、D。
* **修改 Pipeline（流程控制）** ：
  在 `pipeline_judge.py` 中引入**“同质性检查器”**：
* **格式校验** ：检查 4 个选项的小数点位数、单位是否完全一致。
* **长度方差** ：如果干扰项与正确项的文本长度差异超过 20%，触发 `Revise` 重写。

---

### 3. 针对“视觉锚点不够致命 (Text-Only Shortcut)”的修改方案

**核心策略：强制“去词汇化 (De-lexicalization)”与“盲测熔断”**
这是最关键的一点。必须消除题干中对视觉特征的直接描述（如“红色阀门”），强迫求解器去看图。

* **修改 Prompts（Prompt 策略）** ：
  新增或修改 `Revise Prompt`，专门执行**“视觉隐身术”**：
* **指令要求** ：检查题干，将所有 **形容词** （颜色、形状、状态）和**直接读数**替换为**指示性代词**或 **位置描述** 。
* *Before* ：“考虑到图中所示的**红色**报警灯...”
* *After* ：“考虑到图中 **报警装置当前显示的颜色** ...”
* *Before* ：“如图所示，电压为  **220V** ...”
* *After* ：“根据图中 **仪表盘的读数** ...”
* **修改 Pipeline（流程控制）** ：
  利用你已有的 `Strong Solver` 进行 **盲测熔断 (Blindfold Gate)** ：

1. **盲测动作** ：在 Final 生成后，先喂给 Solver  **[全黑图片 + 题干]** 。
2. **判定逻辑** ：
   * 如果 Solver 在**不看图**的情况下答对了（Confidence 高且答案正确）：说明 **题目泄露** 。
   * **处置** ：直接触发 `Revise` 流程，把题目打回去执行上面的“去词汇化”操作。只有当盲测 Solver **答错**或**表示无法回答**时，才允许题目通过。
