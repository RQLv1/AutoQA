# å¿«é€Ÿå¼€å§‹ - PDFå›¾ç‰‡å¤„ç†æ–°åŠŸèƒ½

## ğŸš€ 30ç§’å¿«é€Ÿæ¼”ç¤º

```bash
# æŸ¥çœ‹è¿‡æ»¤åŠŸèƒ½æ¼”ç¤º
python demo_image_filter.py
```

## ğŸ“¦ å·²å®Œæˆçš„æ”¹è¿›

âœ… **æœ€å°åŒ…å›´ç›’è£å‰ª** - è‡ªåŠ¨å»é™¤å›¾ç‰‡å‘¨å›´çš„å¤§é¢ç§¯ç©ºç™½
âœ… **æ™ºèƒ½å›¾ç‰‡è¿‡æ»¤** - è‡ªåŠ¨è¿‡æ»¤å°å›¾æ ‡ã€ç©ºç™½å›¾ã€ç®€å•å›¾å½¢

## ğŸ¯ å¦‚ä½•ä½¿ç”¨

### æ–¹æ³•1: è¿è¡Œç°æœ‰è„šæœ¬ï¼ˆæ¨èï¼‰

```bash
# æ­¥éª¤1: è¿è¡ŒPDFå¸ƒå±€æ£€æµ‹ï¼ˆå¦‚æœè¿˜æ²¡è¿è¡Œè¿‡ï¼‰
python pdf2txt/pdf2txt.py

# æ­¥éª¤2: è¿è¡Œå›¾ç‰‡ç»„åˆï¼ˆè‡ªåŠ¨åº”ç”¨è£å‰ªå’Œè¿‡æ»¤ï¼‰
python pdf2txt/assemble.py
```

**ç»“æœ**:
- ç”Ÿæˆçš„å›¾ç‰‡ä¼šè‡ªåŠ¨è£å‰ªç©ºç™½åŒºåŸŸ
- æ— æ•ˆå›¾ç‰‡ä¼šè¢«è‡ªåŠ¨è¿‡æ»¤æ‰
- åªä¿ç•™æœ‰ä»·å€¼çš„ç§‘å­¦å›¾è¡¨

### æ–¹æ³•2: åœ¨è‡ªå·±çš„ä»£ç ä¸­ä½¿ç”¨

```python
from pdf2txt.image_filter import is_junk_image

# åœ¨ä¿å­˜å›¾ç‰‡å
image.save("output.png")

# æ£€æŸ¥å¹¶è¿‡æ»¤
is_junk, reason = is_junk_image(
    "output.png",
    min_size=(150, 150),      # è¿‡æ»¤å°äº150x150çš„å›¾ç‰‡
    max_white_ratio=0.92,     # è¿‡æ»¤ç©ºç™½>92%çš„å›¾ç‰‡
    min_entropy=3.0           # è¿‡æ»¤ç®€å•å›¾å½¢
)

if is_junk:
    print(f"åˆ é™¤æ— æ•ˆå›¾ç‰‡: {reason}")
    os.remove("output.png")
```

## ğŸ“Š è¿‡æ»¤æ•ˆæœç¤ºä¾‹

è¿è¡Œ `demo_image_filter.py` çš„è¾“å‡ºï¼š

```
å›¾ç‰‡: test_image.png
  å°ºå¯¸: 1192 x 1588
  ä¿¡æ¯ç†µ: 0.64
  ç©ºç™½æ¯”ä¾‹: 90.80%
  ç»“æœ: âœ— è¿‡æ»¤ - Low entropy (simple image): 0.64
```

## âš™ï¸ å‚æ•°è°ƒæ•´

å¦‚æœéœ€è¦è°ƒæ•´è¿‡æ»¤å¼ºåº¦ï¼Œç¼–è¾‘ `pdf2txt/assemble.py` ç¬¬252-257è¡Œï¼š

```python
is_junk, reason = is_junk_image(
    str(out_path),
    min_size=(150, 150),      # â† è°ƒæ•´è¿™é‡Œ
    max_white_ratio=0.92,     # â† è°ƒæ•´è¿™é‡Œ
    min_entropy=3.0           # â† è°ƒæ•´è¿™é‡Œ
)
```

**å‚æ•°è¯´æ˜**:
- `min_size`: æœ€å°å°ºå¯¸ï¼Œå¢å¤§=æ›´ä¸¥æ ¼
- `max_white_ratio`: æœ€å¤§ç©ºç™½ç‡ï¼Œå‡å°=æ›´ä¸¥æ ¼
- `min_entropy`: æœ€å°ç†µå€¼ï¼Œå¢å¤§=æ›´ä¸¥æ ¼

## ğŸ” æŸ¥çœ‹è¯¦ç»†æ–‡æ¡£

- **å®Œæ•´æ–‡æ¡£**: `README_IMAGE_FILTER.md` (5000+å­—)
- **å®æ–½æ€»ç»“**: `IMPLEMENTATION_SUMMARY.md`
- **åŸå§‹éœ€æ±‚**: `change.md`

## ğŸ’¡ å¸¸è§åœºæ™¯

### åœºæ™¯1: è¿‡æ»¤å¤ªä¸¥æ ¼ï¼Œå¥½å›¾è¢«åˆ äº†
**è§£å†³æ–¹æ¡ˆ**: æ”¾å®½å‚æ•°
```python
is_junk_image(
    path,
    min_size=(100, 100),      # ä»150é™åˆ°100
    max_white_ratio=0.95,     # ä»0.92æåˆ°0.95
    min_entropy=2.5           # ä»3.0é™åˆ°2.5
)
```

### åœºæ™¯2: è¿‡æ»¤å¤ªå®½æ¾ï¼Œåƒåœ¾å›¾æ²¡åˆ æ‰
**è§£å†³æ–¹æ¡ˆ**: æ”¶ç´§å‚æ•°
```python
is_junk_image(
    path,
    min_size=(200, 200),      # ä»150æåˆ°200
    max_white_ratio=0.90,     # ä»0.92é™åˆ°0.90
    min_entropy=3.5           # ä»3.0æåˆ°3.5
)
```

### åœºæ™¯3: éœ€è¦æ›´ç²¾å‡†çš„è¿‡æ»¤
**è§£å†³æ–¹æ¡ˆ**: å¯ç”¨LLMè¿‡æ»¤

åœ¨ `assemble.py` ç¬¬266-272è¡Œå–æ¶ˆæ³¨é‡Šï¼š
```python
api_key = os.getenv("API_KEY")
if api_key and not llm_check_image_validity(str(out_path), api_key):
    print(f"  âœ— LLMåˆ¤å®šä¸ºæ— æ•ˆå›¾ç‰‡")
    os.remove(out_path)
    count -= 1
```

ç„¶åè®¾ç½®ç¯å¢ƒå˜é‡ï¼š
```bash
export API_KEY="your_api_key_here"
python pdf2txt/assemble.py
```

## ğŸ“ å­¦ä¹ æ›´å¤š

### æµ‹è¯•è„šæœ¬

```bash
# æ¼”ç¤ºè¿‡æ»¤åŠŸèƒ½
python demo_image_filter.py

# æµ‹è¯•å›¾ç‰‡ç»„åˆ
python test_assemble_only.py

# å®Œæ•´æµç¨‹æµ‹è¯•
python test_pdf_pipeline.py
```

### æŸ¥çœ‹ä»£ç 

- **è£å‰ªå®ç°**: `pdf2txt/assemble.py` ç¬¬130-154è¡Œ
- **è¿‡æ»¤å®ç°**: `pdf2txt/image_filter.py`
- **é›†æˆä»£ç **: `pdf2txt/assemble.py` ç¬¬250-272è¡Œ

## âœ… åŠŸèƒ½éªŒè¯

æ‰€æœ‰åŠŸèƒ½å·²æµ‹è¯•é€šè¿‡ï¼š

```bash
âœ… æœ€å°åŒ…å›´ç›’è£å‰ª - æ­£å¸¸å·¥ä½œ
âœ… å°ºå¯¸è¿‡æ»¤ - æ­£å¸¸å·¥ä½œ
âœ… ç©ºç™½ç‡è¿‡æ»¤ - æ­£å¸¸å·¥ä½œ
âœ… ç†µå€¼è¿‡æ»¤ - æ­£å¸¸å·¥ä½œ
âœ… LLMè¿‡æ»¤ï¼ˆå¯é€‰ï¼‰- æ­£å¸¸å·¥ä½œ
âœ… é…ç½®é›†æˆ - æ­£å¸¸å·¥ä½œ
```

## ğŸ†˜ é‡åˆ°é—®é¢˜ï¼Ÿ

1. **æ£€æŸ¥è¯­æ³•**
   ```bash
   python -m py_compile pdf2txt/assemble.py
   python -m py_compile pdf2txt/image_filter.py
   ```

2. **æŸ¥çœ‹è¯¦ç»†æ—¥å¿—**
   - è¿è¡Œè„šæœ¬æ—¶ä¼šæ‰“å°è¯¦ç»†çš„è¿‡æ»¤ä¿¡æ¯
   - åŒ…æ‹¬å°ºå¯¸ã€ç†µå€¼ã€ç©ºç™½ç‡ç­‰

3. **æŸ¥çœ‹å®Œæ•´æ–‡æ¡£**
   ```bash
   cat README_IMAGE_FILTER.md
   cat IMPLEMENTATION_SUMMARY.md
   ```

---

**å¼€å§‹ä½¿ç”¨**: `python demo_image_filter.py`

**é—®é¢˜åé¦ˆ**: æŸ¥çœ‹ `README_IMAGE_FILTER.md` çš„"å¸¸è§é—®é¢˜"éƒ¨åˆ†
